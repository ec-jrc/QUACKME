!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("rxjs/operators"),require("url"),require("rxjs"),require("@angular/common/http")):"function"==typeof define&&define.amd?define("@auth0/angular-jwt",["exports","@angular/core","rxjs/operators","url","rxjs","@angular/common/http"],t):t(((e=e||self).auth0=e.auth0||{},e.auth0["angular-jwt"]={}),e.ng.core,e.rxjs.operators,e.url,e.rxjs,e.ng.common.http)}(this,(function(e,t,r,o,n,i){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function a(e,t,r,o){var n,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(i<3?n(a):i>3?n(t,r,a):n(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function s(e,t){return function(r,o){t(r,o,e)}}function c(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}var u=new t.InjectionToken("JWT_OPTIONS"),p=function(){function e(e){void 0===e&&(e=null),this.tokenGetter=e&&e.tokenGetter||function(){}}return e.prototype.urlBase64Decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Illegal base64url string!")}return this.b64DecodeUnicode(t)},e.prototype.b64decode=function(e){var t="";if((e=String(e).replace(/=+$/,"")).length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(var r=0,o=void 0,n=void 0,i=0;n=e.charAt(i++);~n&&(o=r%4?64*o+n:n,r++%4)?t+=String.fromCharCode(255&o>>(-2*r&6)):0)n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(n);return t},e.prototype.b64DecodeUnicode=function(e){return decodeURIComponent(Array.prototype.map.call(this.b64decode(e),(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""))},e.prototype.decodeToken=function(e){if(void 0===e&&(e=this.tokenGetter()),!e||""===e)return null;var t=e.split(".");if(3!==t.length)throw new Error("The inspected token doesn't appear to be a JWT. Check to make sure it has three parts and see https://jwt.io for more.");var r=this.urlBase64Decode(t[1]);if(!r)throw new Error("Cannot decode the token.");return JSON.parse(r)},e.prototype.getTokenExpirationDate=function(e){var t;if(void 0===e&&(e=this.tokenGetter()),!(t=this.decodeToken(e))||!t.hasOwnProperty("exp"))return null;var r=new Date(0);return r.setUTCSeconds(t.exp),r},e.prototype.isTokenExpired=function(e,t){if(void 0===e&&(e=this.tokenGetter()),!e||""===e)return!0;var r=this.getTokenExpirationDate(e);return t=t||0,null!==r&&!(r.valueOf()>(new Date).valueOf()+1e3*t)},e.ctorParameters=function(){return[{type:void 0,decorators:[{type:t.Inject,args:[u]}]}]},e=a([t.Injectable(),s(0,t.Inject(u)),c("design:paramtypes",[Object])],e)}(),d=function(){function e(e,t){this.jwtHelper=t,this.tokenGetter=e.tokenGetter,this.headerName=e.headerName||"Authorization",this.authScheme=e.authScheme||""===e.authScheme?e.authScheme:"Bearer ",this.whitelistedDomains=e.whitelistedDomains||[],this.blacklistedRoutes=e.blacklistedRoutes||[],this.throwNoTokenError=e.throwNoTokenError||!1,this.skipWhenExpired=e.skipWhenExpired}return e.prototype.isWhitelistedDomain=function(e){var t=o.parse(e.url,!1,!0);return null===t.host||this.whitelistedDomains.findIndex((function(e){return"string"==typeof e?e===t.host:e instanceof RegExp&&e.test(t.host)}))>-1},e.prototype.isBlacklistedRoute=function(e){var t=e.url;return this.blacklistedRoutes.findIndex((function(e){return"string"==typeof e?e===t:e instanceof RegExp&&e.test(t)}))>-1},e.prototype.handleInterception=function(e,t,r){var o,n=!1;if(!e&&this.throwNoTokenError)throw new Error("Could not get token from tokenGetter function.");return this.skipWhenExpired&&(n=!e||this.jwtHelper.isTokenExpired(e)),e&&n&&this.skipWhenExpired?t=t.clone():e&&(t=t.clone({setHeaders:(o={},o[this.headerName]=""+this.authScheme+e,o)})),r.handle(t)},e.prototype.intercept=function(e,t){var o=this;if(!this.isWhitelistedDomain(e)||this.isBlacklistedRoute(e))return t.handle(e);var i=this.tokenGetter();return i instanceof Promise?n.from(i).pipe(r.mergeMap((function(r){return o.handleInterception(r,e,t)}))):this.handleInterception(i,e,t)},e.ctorParameters=function(){return[{type:void 0,decorators:[{type:t.Inject,args:[u]}]},{type:p}]},e=a([t.Injectable(),s(0,t.Inject(u)),c("design:paramtypes",[Object,p])],e)}(),l=function(){function e(e){if(e)throw new Error("JwtModule is already loaded. It should only be imported in your application's main module.")}var r;return r=e,e.forRoot=function(e){return{ngModule:r,providers:[{provide:i.HTTP_INTERCEPTORS,useClass:d,multi:!0},e.jwtOptionsProvider||{provide:u,useValue:e.config},p]}},e.ctorParameters=function(){return[{type:e,decorators:[{type:t.Optional},{type:t.SkipSelf}]}]},e=r=a([t.NgModule(),s(0,t.Optional()),s(0,t.SkipSelf()),c("design:paramtypes",[e])],e)}();e.JWT_OPTIONS=u,e.JwtHelperService=p,e.JwtInterceptor=d,e.JwtModule=l,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=auth0-angular-jwt.umd.min.js.map